<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Global - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/LTLA/bakana" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Classes</h3><ul><li><a href="CellLabellingState.html">CellLabellingState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CellLabellingState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="CellLabellingState.html#summary">summary</a></li></ul></li><li><a href="ChooseClusteringState.html">ChooseClusteringState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ChooseClusteringState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="ChooseClusteringState.html#summary">summary</a></li></ul></li><li><a href="CustomSelectionsState.html">CustomSelectionsState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CustomSelectionsState.html#addSelection">addSelection</a></li><li data-type='method' style='display: none;'><a href="CustomSelectionsState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="CustomSelectionsState.html#fetchResults">fetchResults</a></li><li data-type='method' style='display: none;'><a href="CustomSelectionsState.html#removeSelection">removeSelection</a></li><li data-type='method' style='display: none;'><a href="CustomSelectionsState.html#summary">summary</a></li></ul></li><li><a href="FeatureSelectionState.html">FeatureSelectionState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FeatureSelectionState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="FeatureSelectionState.html#summary">summary</a></li></ul></li><li><a href="InputsState.html">InputsState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="InputsState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="InputsState.html#fetchAnnotations">fetchAnnotations</a></li><li data-type='method' style='display: none;'><a href="InputsState.html#summary">summary</a></li></ul></li><li><a href="KmeansClusterState.html">KmeansClusterState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="KmeansClusterState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="KmeansClusterState.html#summary">summary</a></li></ul></li><li><a href="MarkerDetectionState.html">MarkerDetectionState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MarkerDetectionState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="MarkerDetectionState.html#fetchGroupResults">fetchGroupResults</a></li><li data-type='method' style='display: none;'><a href="MarkerDetectionState.html#numberOfGroups">numberOfGroups</a></li><li data-type='method' style='display: none;'><a href="MarkerDetectionState.html#summary">summary</a></li></ul></li><li><a href="NeighborIndexState.html">NeighborIndexState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="NeighborIndexState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="NeighborIndexState.html#summary">summary</a></li></ul></li><li><a href="NormalizationState.html">NormalizationState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="NormalizationState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="NormalizationState.html#fetchExpression">fetchExpression</a></li><li data-type='method' style='display: none;'><a href="NormalizationState.html#summary">summary</a></li></ul></li><li><a href="PcaState.html">PcaState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PcaState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="PcaState.html#summary">summary</a></li></ul></li><li><a href="QualityControlState.html">QualityControlState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="QualityControlState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="QualityControlState.html#fetchFilteredAnnotations">fetchFilteredAnnotations</a></li><li data-type='method' style='display: none;'><a href="QualityControlState.html#fetchFilteredBlock">fetchFilteredBlock</a></li><li data-type='method' style='display: none;'><a href="QualityControlState.html#summary">summary</a></li></ul></li><li><a href="SnnGraphClusterState.html">SnnGraphClusterState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SnnGraphClusterState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="SnnGraphClusterState.html#summary">summary</a></li></ul></li><li><a href="TsneState.html">TsneState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TsneState.html#animate">animate</a></li><li data-type='method' style='display: none;'><a href="TsneState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="TsneState.html#summary">summary</a></li></ul></li><li><a href="UmapState.html">UmapState</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UmapState.html#animate">animate</a></li><li data-type='method' style='display: none;'><a href="UmapState.html#compute">compute</a></li><li data-type='method' style='display: none;'><a href="UmapState.html#summary">summary</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#analysisDefaults">analysisDefaults</a></li><li><a href="global.html#availableReaders">availableReaders</a></li><li><a href="global.html#callScran">callScran</a></li><li><a href="global.html#createAnalysis">createAnalysis</a></li><li><a href="global.html#createKanaFile">createKanaFile</a></li><li><a href="global.html#freeAnalysis">freeAnalysis</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#loadAnalysis">loadAnalysis</a></li><li><a href="global.html#parseKanaFile">parseKanaFile</a></li><li><a href="global.html#removeHDF5File">removeHDF5File</a></li><li><a href="global.html#runAnalysis">runAnalysis</a></li><li><a href="global.html#saveAnalysis">saveAnalysis</a></li><li><a href="global.html#setCellLabellingDownload">setCellLabellingDownload</a></li><li><a href="global.html#setCreateLink">setCreateLink</a></li><li><a href="global.html#setResolveLink">setResolveLink</a></li><li><a href="global.html#setVisualizationAnimate">setVisualizationAnimate</a></li><li><a href="global.html#terminate">terminate</a></li><li><a href="global.html#validateAnnotations">validateAnnotations</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Global</h1>
    

    




<section>

<header>
    
        <h2>
        
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




            

            
        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="availableReaders"><span class="type-signature"></span>availableReaders<span class="type-signature"></span></h4>





<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="utils_inputs.js.html">utils/inputs.js</a>, <a href="utils_inputs.js.html#line82">line 82</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>List of available readers.
Each key specifies a matrix format; the corresponding value should be an ES6 module containing methods to interpret that format.</p>
</div>








        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="analysisDefaults"><span class="type-signature"></span>analysisDefaults<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="defaults.js.html">defaults.js</a>, <a href="defaults.js.html#line19">line 19</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Generate an object containing all of the default analysis parameters.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object where each property corresponds to an analysis step and contains the default parameters for that step.
See the documentation for each step's <code>compute</code> method for more details:</p>
<ul>
<li><a href="InputsState.html#compute"><code>inputs</code></a></li>
<li><a href="QualityControlState.html#compute"><code>quality_control</code></a></li>
<li><a href="FeatureSelectionState.html#compute"><code>feature_selection</code></a></li>
<li><a href="PcaState.html#compute"><code>pca</code></a></li>
<li><a href="NeighborIndexState.html#compute"><code>neighbor_index</code></a></li>
<li><a href="TsneState.html#compute"><code>tsne</code></a></li>
<li><a href="UmapState.html#compute"><code>umap</code></a></li>
<li><a href="KmeansClusterState.html#compute"><code>kmeans_cluster</code></a></li>
<li><a href="SnnGraphClusterState.html#compute"><code>snn_graph_cluster</code></a></li>
<li><a href="ChooseClusteringState.html#compute"><code>choose_clustering</code></a></li>
<li><a href="CellLabellingState.html#compute"><code>cell_labelling</code></a></li>
</ul>
</div>



    



        
            

    

    <h4 class="name" id="callScran"><span class="type-signature"></span>callScran<span class="signature">(fun)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line580">line 580</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Call a <strong>scran.js</strong> function.
This allows client applications to operate in the same <strong>scran.js</strong> memory space as <strong>bakana</strong> functions,
which is not guaranteed if applications import <strong>scran.js</strong> on their own (e.g., due to name mangling with Webpack).</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A function that accepts the <strong>scran.js</strong> module object and presumably calls some of its functions.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The return value of <code>fun</code>.</p>
</div>



    



        
            

    

    <h4 class="name" id="createAnalysis"><span class="type-signature"></span>createAnalysis<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line87">line 87</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Create a new analysis state in preparation for calling <a href="global.html#runAnalysis"><code>runAnalysis</code></a>.
Multiple states can be created and used interchangeably within the same Javascript runtime.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to an object containing states for all analysis steps.
This object can be used as input into <a href="global.html#runAnalysis"><code>runAnalysis</code></a>.</p>
</div>



    



        
            

    

    <h4 class="name" id="createKanaFile"><span class="type-signature"></span>createKanaFile<span class="signature">(statePath, inputFiles, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line528">line 528</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Create a <code>*.kana</code> file from the HDF5 state file and the various data files.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>statePath</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>String containing a file path to an existing HDF5 state file.
This should be the same as the <code>path</code> used in <a href="global.html#saveAnalysis"><code>saveAnalysis</code></a>.
On browsers, the path should exist inside the virtual file system of the <strong>scran.js</strong> module.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>inputFiles</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Array of files to be embedded into the <code>*.kana</code> file.
On Node.js, this should be an array of file paths; on browsers, this should be an array of ArrayBuffers.
Typically this is obtained as the resolved return value of <a href="global.html#saveAnalysis"><code>saveAnalysis</code></a>.</p>
<p>If <code>null</code>, it is assumed that files are linked instead of embedded.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Further options.
For Node.js, callers can specify <code>outputPath</code>, a string containing the output path for the newly created <code>*.kana</code> file.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>For Node.js, a promise is returned that resolves to a path to a new <code>*.kana</code> file.
This is equal to <code>outputPath</code> if supplied, otherwise a path to a file in a temporary directory is returned.</p>
<p>In browsers, an ArrayBuffer is returned containing the full contents of the new <code>*.kana</code> file.</p>
</div>



    



        
            

    

    <h4 class="name" id="freeAnalysis"><span class="type-signature"></span>freeAnalysis<span class="signature">(state)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line117">line 117</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Free the contents of an analysis state.
This releases memory on the <strong>scran.js</strong> Wasm heap and terminates any workers associated with this analysis.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>state</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last"><p>An existing analysis state, produced by <a href="global.html#createAnalysis"><code>createAnalysis</code></a> or <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a>.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to <code>null</code> when all states are freed.</p>
</div>



    



        
            

    

    <h4 class="name" id="initialize"><span class="type-signature"></span>initialize<span class="signature">(options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line59">line 59</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Initialize the backend for computation.
This is required prior to running any other <strong>bakana</strong> function.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional parameters.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>numberOfThreads</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Number of threads used by <strong>scran.js</strong>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>localFile</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Whether to use local file paths for imported modules in <strong>scran.js</strong>.
This only needs to be <code>true</code> for old Node versions that do not support file URIs.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to <code>null</code> when initialization is complete.</p>
</div>



    



        
            

    

    <h4 class="name" id="loadAnalysis"><span class="type-signature"></span>loadAnalysis<span class="signature">(path, loadFun, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line383">line 383</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Load an analysis state from a HDF5 state file, usually excised from a <code>*.kana</code> file.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Path to the HDF5 file containing the analysis state.
On browsers, this should lie inside the virtual file system of the <strong>scran.js</strong> module.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>loadFun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Function to load each embedded data file.
This should accept two arguments - an offset to the start of the file in the embedded file buffer, and the size of the file.</p>
<p>In the browser, the function should return an ArrayBuffer containing the contents of the file.
For Node.js, the function should return a string containing a path to the file.
In both cases, the function may instead return a promise that resolves to the expected values.</p>
<p>Note that this function is only used if the state file at <code>path</code> contains information for embedded files;
otherwise, links are resolved using reader-specific functions (see <a href="global.html#setResolveLink"><code>setResolveLink</code></a> for the common use cases).</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional parameters.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>finishFun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Function that is called on after extracting results for each step.
This should accept two arguments - the name of the step and an object containing the results of that step.
If <code>null</code>, a no-op function is automatically created.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An object with the following properties:</p>
<ul>
<li><code>parameters</code>: an object containing the analysis parameters, similar to that created by <a href="global.html#analysisDefaults"><code>analysisDefaults</code></a>.</li>
<li><code>state</code>: an object containing the loaded analysis state.
This is conceptually equivalent to creating a state with <a href="global.html#createAnalysis"><code>createAnalysis</code></a> and running it through <a href="global.html#runAnalysis"><code>runAnalysis</code></a> with the associated <code>parameters</code>.</li>
</ul>
</div>



    



        
            

    

    <h4 class="name" id="parseKanaFile"><span class="type-signature"></span>parseKanaFile<span class="signature">(input, statePath, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line552">line 552</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Parse a <code>*.kana</code> file by extracting the HDF5 state file and returning a function to extract embeddded data files.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>input</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>
|

<span class="param-type">ArrayBuffer</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The input <code>*.kana</code> file.
For Node.js, this should be a string containing a path to the file.
On browsers, this should be an ArrayBuffer containing the full file contents.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>statePath</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>String containing a file path to save the HDF5 state file.
This will also be the path supplied to <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a> to load the state into memory.
On browsers, this will exist inside the virtual file system of the <strong>scran.js</strong> module.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Further options.
For Node.js, callers can specify <code>stageDir</code>, a string containing a path to a staging directory for the extracted data files.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The HDF5 state file is written to <code>statePath</code>.
In the browser, if <code>input</code> contains embedded files, a function is returned that extracts each data file given its offset and size.
(This should be used as <code>loadFun</code> in <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a>.)
If <code>input</code> contains linked files, <code>null</code> is returned.</p>
<p>For Node.js, a promise is returned that evaluates to the aforementioned function or <code>null</code>.</p>
</div>



    



        
            

    

    <h4 class="name" id="removeHDF5File"><span class="type-signature"></span>removeHDF5File<span class="signature">(path)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line566">line 566</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Remove a HDF5 file at the specified path, typically corresponding to the value of <code>statePath</code> in <a href="global.html#saveAnalysis"><code>saveAnalysis</code></a> or <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a>.
Such files are typically temporary intermediates that are generated from or used to generate a <code>*.kana</code> file.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Path to a HDF5 file.
On browsers, this path will exist inside the <strong>scran.js</strong> virtual filesystem.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The specified file is removed.
If the file does not exist, this function is a no-op.</p>
</div>



    



        
            

    

    <h4 class="name" id="runAnalysis"><span class="type-signature"></span>runAnalysis<span class="signature">(state, matrices, params, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line162">line 162</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Run a basic single-cell RNA-seq analysis with the specified files and parameters.
This will cache the results from each step so that, if the parameters change, only the affected steps will be rerun.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>state</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Object containing the analysis state, produced by <a href="global.html#createAnalysis"><code>createAnalysis</code></a> or <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a>.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>matrices</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Object where each (arbitrarily named) property corresponds to an input matrix.
Each matrix should be an object with <code>type</code> string property and any number of additional properties referring to individual data files.</p>
<ul>
<li>If <code>type: &quot;MatrixMarket&quot;</code>, the object should contain an <code>mtx</code> property, referring to a (possibly Gzipped) Matrix Market file containing a count matrix.
The object may contain a <code>genes</code> property, referring to a (possibly Gzipped) tab-separated file with the gene ID and symbols for each row of the count matrix.
The object may contain a <code>annotation</code> property, referring to a (possibly Gzipped) tab-separated file with the gene ID and symbols for each row of the count matrix.</li>
<li>If <code>type: &quot;10X&quot;</code>, the object should contain an <code>h5</code> property, referring to a HDF5 file following the 10X Genomics feature-barcode matrix format.
It is assumed that the matrix has already been filtered to contain only the cell barcodes.</li>
<li>If <code>type: &quot;H5AD&quot;</code>, the object should contain an <code>h5</code> property, referring to a H5AD file.</li>
</ul>
<p>The representation of each reference to a data file depends on the runtime.
In the browser, each data file manifests as a <code>File</code> object; for Node.js, each data file should be represented as a string containing a file path.</p>
<p>Alternatively, <code>matrices</code> may be <code>null</code>, in which case the count matrices are extracted from <code>state</code>.
This assumes that the data matrices were already cached in <code>state</code>, either from a previous call to <a href="global.html#runAnalysis"><code>runAnalysis</code></a> or from @{linkcode loadAnalysis}.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>An object containing parameters for all steps.
See <a href="global.html#analysisDefaults"><code>analysisDefaults</code></a> for more details.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional parameters.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>startFun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Function that is called when each step is started.
This should accept a single argument - the name of the step.
If <code>null</code>, nothing is executed.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>finishFun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Function that is called on successful execution of each step.
This should accept two arguments - the name of the step and an object containing the results of that step.
(The latter will be undefined if the step uses a previously cached result.)
If <code>null</code>, nothing is executed.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to <code>null</code> when all asynchronous analysis steps are complete.
The contents of <code>state</code> are modified by reference to reflect the latest state of the analysis with the supplied parameters.</p>
</div>



    



        
            

    

    <h4 class="name" id="saveAnalysis"><span class="type-signature"></span>saveAnalysis<span class="signature">(state, path, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line316">line 316</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Save the current analysis state into a HDF5 file.
This HDF5 file can then be embedded into a <code>*.kana</code> file for distribution.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>state</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Object containing the analysis state, produced by <a href="global.html#createAnalysis"><code>createAnalysis</code></a> or <a href="global.html#loadAnalysis"><code>loadAnalysis</code></a>.
If produced by <a href="global.html#createAnalysis"><code>createAnalysis</code></a>, it should have been run through <a href="global.html#runAnalysis"><code>runAnalysis</code></a> beforehand.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Path to the output HDF5 file.
On browsers, this will lie inside the virtual file system of the <strong>scran.js</strong> module.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional parameters.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>embedded</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Whether to store information for embedded data files.
If <code>false</code>, links to data files are stored instead, see <a href="global.html#setCreateLink"><code>setCreateLink</code></a>.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A HDF5 file is created at <code>path</code> containing the analysis parameters and results - see https://ltla.github.io/kanaval for more details on the structure.
If <code>embedded = false</code>, a promise is returned that resolves to <code>null</code> when the saving is complete.
Otherwise, an object is returned containing:</p>
<ul>
<li><code>collected</code>: an array of length equal to the number of data files.
If <code>linkFun: null</code>, each element is an ArrayBuffer containing the file contents, which can be used to assemble an embedded <code>*.kana</code> file.
Otherwise, if <code>linkFun</code> is supplied, each element is a string containing the linking identifier to the corresponding file.</li>
<li><code>total</code>: an integer containing the total length of all ArrayBuffers in <code>collected</code>.
This will only be present if <code>linkFun</code> is not supplied.</li>
</ul>
</div>



    



        
            

    

    <h4 class="name" id="setCellLabellingDownload"><span class="type-signature"></span>setCellLabellingDownload<span class="signature">(fun)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="cell_labelling.js.html">cell_labelling.js</a>, <a href="cell_labelling.js.html#line442">line 442</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Specify a function to download references for the cell labelling step.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Function that accepts a single string containing a URL,
and returns an ArrayBuffer of that URL's contents.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p><code>fun</code> is set as the global downloader for this step.
The <em>previous</em> value of the downloader is returned.</p>
</div>



    



        
            

    

    <h4 class="name" id="setCreateLink"><span class="type-signature"></span>setCreateLink<span class="signature">(fun)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="utils_reader.js.html">utils/reader.js</a>, <a href="utils_reader.js.html#line69">line 69</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Specify a function to create links for data files.
By default, this only affects files for the MatrixMarket, H5AD and 10X formats, and is only used when linking is requested.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Function that returns a linking idenfier to a data file.
The function should accept the following arguments:</p>
<ul>
<li>A string specifying the type of the file, e.g., <code>&quot;mtx&quot;</code>, <code>&quot;h5&quot;</code>.</li>
<li>A string containing the name of the file.</li>
<li>An ArrayBuffer containing the file content (for browsers) or a string containing the file path (for Node.js),</li>
</ul>
<p>The function is expected to return a string containing some unique identifier to the file.
This is most typically used to register the file with some user-specified database system for later retrieval.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p><code>fun</code> is set as the global link creator for this step.
The <em>previous</em> value of the creator is returned.</p>
</div>



    



        
            

    

    <h4 class="name" id="setResolveLink"><span class="type-signature"></span>setResolveLink<span class="signature">(fun)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="utils_reader.js.html">utils/reader.js</a>, <a href="utils_reader.js.html#line85">line 85</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Specify a function to resolve links for data files.
By default, this only affects files for the MatrixMarket, H5AD and 10X formats, and is only used when links are detected.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Function that accepts a string containing a linking idenfier and returns an ArrayBuffer containing the file content (for browsers) or a string containing the file path (for Node.js),
This is most typically used to retrieve a file from some user-specified database system.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p><code>fun</code> is set as the global resolver for this step.
The <em>previous</em> value of the resolver is returned.</p>
</div>



    



        
            

    

    <h4 class="name" id="setVisualizationAnimate"><span class="type-signature"></span>setVisualizationAnimate<span class="signature">(fun)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="utils_viz_parent.js.html">utils/viz_parent.js</a>, <a href="utils_viz_parent.js.html#line21">line 21</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Specify a function to handle animation iterations for the low-dimensional embeddings.
The exact nature of this handling is arbitrary - developers may post the contents to another thread, save them to file, etc.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fun</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Function to process each animation iteration.
This should accept four arguments, in the following order:</p>
<ul>
<li>A string containing either <code>&quot;tsne&quot;</code> or <code>&quot;umap&quot;</code>.</li>
<li>A <code>Float64Array</code> containing the x-coordinates for each cell.</li>
<li>A <code>Float64Array</code> containing the y-coordinates for each cell.</li>
<li>An integer specifying the iteration number.</li>
</ul></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p><code>fun</code> is set as the global animator function for t-SNE and UMAP.
The <em>previous</em> value of the animator is returned.</p>
</div>



    



        
            

    

    <h4 class="name" id="terminate"><span class="type-signature"></span>terminate<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="index.js.html">index.js</a>, <a href="index.js.html#line74">line 74</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Terminate the backend, in particular shutting down all workers.
This is typically necessary for a clean shutdown in Node.js applications.</p>
</div>

























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to <code>null</code> when all workers are terminated.</p>
</div>



    



        
            

    

    <h4 class="name" id="validateAnnotations"><span class="type-signature"></span>validateAnnotations<span class="signature">(matrices)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="preflight.js.html">preflight.js</a>, <a href="preflight.js.html#line26">line 26</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Perform preflight validation of the annotations in the input matrices.</p>
<p>This is usually done in regards to the consistency of gene annotations for multiple matrices.
If multiple matrices are present, an error is raised if any matrix does not contain gene annotations;
or there is no common species and feature type for annotations across all matrices;
or the intersection of genes is empty.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>matrices</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last"><p>An object where each property is itself an object representing a single input matrix.
See the argument of the same name in <a href="global.html#runAnalysis"><code>runAnalysis</code></a> for more details.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A promise that resolves to an object containing preflight check information:</p>
<ul>
<li><code>annotations</code>: an object where each property corresponds to an input matrix in <code>matrices</code>.
Each element is an array containing the names of the cell annotation fields in the corresponding matrix;
or <code>null</code>, if that matrix does not contain any annotations.</li>
</ul>
<p>If <code>matrices</code> has more than one matrix, the output will also contain:</p>
<ul>
<li><code>common_genes</code>: an integer containing the number of common genes across all matrices.</li>
<li><code>best_gene_fields</code>: an object where each property corresponds to an input matrix in <code>matrices</code>.
Each property is a string containing the name of the gene annotation field that was chosen for the intersection in the corresponding matrix.</li>
</ul>
</div>



    



        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Fri Apr 22 2022 06:37:59 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>